# BurpSuite configuration for pentest VMs
# Uses burpsuite-nix flake for extensions management
{ config, pkgs, lib, burpsuite-nix, ... }:

let
  username = config.hydrix.username;
in {
  # Configure BurpSuite via home-manager for VM user
  home-manager.users.${username} = {
    imports = [ burpsuite-nix.homeManagerModules.default ];

    programs.burp = {
      enable = true;

      # Extensions to load
      # Note: active-scan-plus-plus removed due to hash mismatch in upstream
      extensions = [
        "403-bypasser"
        "json-web-tokens"
        "js-miner"
        "param-miner"
        "autorize"
        { package = "http-request-smuggler"; loaded = false; }
      ];

      # Edition (Community is free, Pro requires license)
      edition = [ "Community" ];

      # UI settings
      settings = {
        display.user_interface = {
          look_and_feel = "Dark";
          font_size = "14";
        };
      };
    };
  };
}
